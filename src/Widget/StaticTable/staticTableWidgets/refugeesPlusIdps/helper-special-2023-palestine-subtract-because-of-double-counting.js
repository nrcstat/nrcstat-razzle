/**
 * Comment on 11 June 2024 written during preparations for RefRep2024 that publishes data about the world
 * refugee situation for the year 2023.
 * As of 2023, many Palestiniains already had refugee status. During the year of 2023, because of the latest
 * Israeli-Palestinian conflict, a large number - 1197000 to be exact - of Palestinians who were already
 * counted as refugees in UNHCR/UNRWA totals were RECOUNTED as internally displaced people. The number 1197000
 * is the official estimate of how many persons have been double-counted.
 * We _do_ count them as both refugees and IDPs in all system visualizations generated by NrcStat. However,
 * in the four system tables generated by the code in the four other files in this folder, we sum the number
 * of refugees with the number of IDPs to compute the total number of forcibly displaced people.
 * After conferring with Lars, we decided that in these four system tables we will substract the number so that
 * they're not counted twice in the computed totals.
 * The below function scans an array of data points returned fromt the Loopback /datas endpoint, and acts on
 * a datapoint to manually subtract 1197000 from it.
 */

export function subtractDoubleCountedPalestineIndividuals(
  datas,
  dataPointToSubtractFrom
) {
  datas = datas.map((data) => {
    if (
      data.year === 2023 &&
      data.countryCode === 'PS' &&
      data.dataPoint === dataPointToSubtractFrom
    ) {
      data.data -= 1197000
    }
    return data
  })
  return datas
}
